<%- assert_locals method -%>

Gapic::Rest::ServerStream.new(
  Gapic::Rest::ThreadedFiberEnumerator.new do 
    @<%= method.service.stub_name %>.<%= method.name %> request, options do |req|
      req.options.on_data = Proc.new do |chunk, overall_received_bytes|
        Fiber.yield chunk
      end
    end
    nil
  end,
  <%= method.return_type %>,
)
